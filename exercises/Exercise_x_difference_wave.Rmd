---
title: "Difference waves"
output: html_notebook
---


### Difference waves

A very useful tool when plotting ERPs is the difference wave. It's simpler to subtract two columns from each other than it is to subtract groups of rows from a single column. Thus, we need to make our data wide again.

We can use spread() for this. It is the opposite of gather() and has the same syntax.

To make this a little more interesting, let's try out pipes (*%>%*) and *mutate()*.

Pipe the output from *spread()* down to text line and use *mutate()* to create a new variable - the difference between objects and non-objects.

Assign it to a new data frame.

```
difference_df <- spread(final_df, Object, amplitude) %>%
  mutate(difference = Object - `Non-Object`)

head(difference_df)
```

```{r spreading_data}
difference_df <- spread(difference_df, Object, amplitude) %>%
  mutate(difference = Object - `Non-Object`)

head(difference_df)
```

The data frame now has the difference between objects and non-objects for each level of spatial frequency. 

Create an ERP plot facetted on Spatial Frequency to plot the difference between objects and non-objects in for each level of spatial frequency. Instead of using, *facet_wrap()*, try using *facet_grid()*. This will allow you to stack the facets vertically by using the following 

facet_grid(varname ~ .)

Add confidence intervals as above.

```{r}
difference_df %>%
  ggplot(aes(x = Time, y = difference, fill = `Spatial Frequency`)) +
  stat_summary(fun.data = mean_cl_normal, geom = "ribbon", alpha = 0.2)+
  stat_summary(fun.y = mean, geom = "line") +
  facet_grid(`Spatial Frequency`~.)
```